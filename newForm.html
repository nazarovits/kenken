<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" type="text/css" href="style.css">
    <script src="https://code.jquery.com/jquery-1.11.3.min.js"></script>
    <title></title>
</head>
<body>

<div class="box-inner-main">
    <div id="trash1"></div>
    <div id="trash2"></div>
</div>


<script type="text/javascript">

    // function which draw out HTML version of flash puzzle
    function drawOurForm(puzzleData){
        var data = (puzzleData && puzzleData.dataObj) ? puzzleData.dataObj : {};
        var row = [];
        var puzzleSize = puzzleData.size;
        var values = data.A;
        var results = data.T;
        var symbols = data.S;
        var rightLines = data.V;
        var bottomLines = data.H;
        var lineClass;
        var result;
        var i,j;

        // ******* left panel begin
        row.push('<div>');

            // ******* notes box
            row.push('<div id="notesContainer">');

            for (i=1; i<=puzzleSize; i+=1){
                row.push('<div class="notesItem" data-id="'+i+'">'+i+'<\/div>');
            }
            row.push('<div id="notesAll">OK<\/div>');
            row.push('<div id="notesDel">DEL<\/div>');

            row.push('<\/div>');

            // ******* first buttons box
            row.push('<div class="firstBtnBox">');
                row.push('<input type="button" id="btnSolve" value="Solve Another">');
                row.push('<input type="button" id="btnResumeSaved" value="Resume Saved Puzzle">');
            row.push('<\/div>');

            // ******* second buttons box
            row.push('<div class="secondBtnBox">');
                row.push('<input type="button" id="btnUndo" value="Undo">');
                row.push('<input type="button" id="btnRendo" value="Rendo">');
                row.push('<input type="button" id="btnReset" value="Reset">');
            row.push('<\/div>');

            // ******* third buttons box
            row.push('<div class="thirdBtnBox">');
                row.push('<input type="button" id="btnReveal" value="Reveal">');
                row.push('<input type="button" id="btnCheck" value="Check">');
                row.push('<input type="button" id="btnSolution" value="Solution">');
            row.push('<\/div>');

        // ******* left panel end
        row.push('<\/div>');

        // ******* main panel begin
        row.push('<div>');

            // ******* top buttons
            row.push('<div id="topInfoBox">');

            row.push('<span id="puzzleInfo">Puzzle No. 000000<\/span>');
            row.push('<span id="puzzleTimer">00:00:00<\/span>');
            row.push('<input type="button" id="btnOffTimer" value="OFF">');
            row.push('<input type="button" id="btnPause" value="PAUSE">');

            row.push('<\/div>');

            // ******* main container
            row.push('<div id="puzzleContainer">');

            for (i=1; i<=puzzleSize; i+=1){
                row.push('<div class="puzzleRow">');
                for (j=1; j<=puzzleSize; j+=1 ){

                    lineClass = 'puzzleItem';

                    if (+rightLines[i-1][j-1]) {
                        lineClass += ' rightLineBorder'
                    }

                    if (+bottomLines[j-1][i-1]) {
                        lineClass += ' bottomLineBorder'
                    }

                    //puzzle item
                    row.push('<div id="p'+i+j+'" class="'+lineClass+'">');

                        //draw symbol and expected result
                        if (+results[i-1][j-1]){
                            row.push('<span class="itemResult">'+results[i-1][j-1]+'<\/span>');
                            if (symbols[i-1][j-1] !== '0' && symbols[i-1][j-1] !== '1'){
                                row.push('<span class="itemSymbol">'+symbols[i-1][j-1]+'<\/span>');
                            }
                        }

                        row.push('<span class="itemValue"><\/span>');

                    row.push('<\/div>');
                }
                row.push('<\/div>');
            }

            row.push('<\/div>');

            // ******* bottom container
            row.push('<div id="bottomInfoBox">');

            row.push('<span>AutoNotes</span>');
            row.push('<input type="button" id="btnOnNotes" value="ON">');
            row.push('<input type="button" id="btnOffNotes" value="OFF">');

            row.push('<input type="button" id="btnSave" value="SAVE">');
            row.push('<input type="button" id="btnPrint" value="PRINT">');

            row.push('<\/div>');

        // ******* main panel end
        row.push('<\/div>');

        // +++++++ test circle

        row.push('<div id="testCircle">');

        for (i=1; i<=puzzleSize; i+=1){
            row.push('<div data-id="'+i+'" class="ltlCrcl">');
            row.push('<span>'+i+'<\/span>');
            row.push('<\/div>');
        }

            row.push('<div data-id="cC" class="ltlCrcl"><span>C<\/span><\/div>');
            row.push('<div data-id="cX" class="ltlCrcl"><span>X<\/span><\/div>');

        row.push('<\/div>');

        // +++++++ test circle

        result = document.createElement('div');
        result.className = 'mainContainer';
        result.innerHTML = row.join('');

        document.querySelector('.box-inner-main').appendChild(result);

        drawOurCircles();

        $('.puzzleItem').on('click', function(event) {
            var target = $(event.target).closest('.puzzleItem');
            var container = target.closest('#puzzleContainer');
            var circlePos;

            container.find('.active').removeClass('active');
            target.addClass('active');

            changeCirclePosition ();
        });

        $('.ltlCrcl').on('click', function(event){
            var target = $(event.target).closest('.ltlCrcl');
            var value = target.attr('data-id');
            var circle = target.closest('#testCircle');

            if (value !== 'cX') {
                if (value === 'cC'){value = ''}
                $('.puzzleItem.active').find('.itemValue').text(value);
            }
            circle.hide();
        });

    }

    function changeCirclePosition (){
        var circleDiv = $('#testCircle');
        var circlePos = findCirclePosition(60);

        circleDiv.css('top', circlePos.y);
        circleDiv.css('left', circlePos.x);
        circleDiv.css('display', 'block');
    };

    function drawOurCircles (){
        var count = testObject.size + 2;
        var coordinates = calculateCircleButtons(60, count);
        var arrayCircles = $('.ltlCrcl');
        var top, left;

        for (var i=1; i<=count; i+=1){
            top = coordinates[i-1].y - 15;
            left = coordinates[i-1].x - 15;
            $(arrayCircles[i-1]).css({top: top, left: left})
        }

    };


    function calculateCircleButtons(argRadius, argCount) {
        var radius = argRadius;
        var count = argCount;
        var coordinatesArray = [];
        var x;
        var y;

        for (var i = 0; i < count; i++){
            x = radius + radius * Math.sin(2 / count * Math.PI * i);
            y = radius - radius * Math.cos(2 / count * Math.PI * i);

            coordinatesArray.push({x: x, y : y});
        }

        return coordinatesArray;

    };

    function findCirclePosition (circleRadius) {
        var activeSquare = $('.puzzleItem.active')[0];
        var squareWidth = activeSquare.offsetWidth;
        var squareLeft = activeSquare.offsetLeft;
        var squareTop = activeSquare.offsetTop;

        return {
            x: squareLeft + (squareWidth/2) - circleRadius,
            y: squareTop + (squareWidth/2) - circleRadius
        };
    }

    // *************************************
    var testObject = {
        size    : 3,
        dataObj : {
            A: [['1', '2', '3'], ['2', '3', '1'], ['3', '1', '2']],
            T: [['3', '0', '4'], ['5', '0', '0'], ['3', '3', '0']],
            S: [['+', '0', '+'], ['+', '0', '0'], ['0', '+', '0']],
            V: [['0', '1'],      ['0', '1'],      ['1', '0']],
            H: [['1', '1'],      ['1', '1'],      ['0', '1']]
        }
    };

    drawOurForm(testObject);
    // *************************************
</script>

</body>